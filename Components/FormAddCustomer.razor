@using Models
@using Services

@inject ThaiData ThaiDataService

<RadzenTemplateForm TItem="Customer" Data="Customer">
    <RadzenRow class="rz-mb-2">
        <RadzenColumn>
            <RadzenLabel Text="รหัสผลิตภัณท์"></RadzenLabel>
        </RadzenColumn>
        <RadzenColumn>
            <RadzenTextBox @bind-Value="Customer.Licensecode" />
        </RadzenColumn>
    </RadzenRow>
    <RadzenRow class="rz-mb-2">
        <RadzenColumn>
            <RadzenLabel Text="รหัสร้านค้า"></RadzenLabel>
        </RadzenColumn>
        <RadzenColumn>
            <RadzenTextBox @bind-Value="Customer.ShopCode" />
        </RadzenColumn>
    </RadzenRow>
    <RadzenRow class="rz-mb-2">
        <RadzenColumn>
            <RadzenLabel Text="ชื่อร้าน"></RadzenLabel>
        </RadzenColumn>
        <RadzenColumn>
            <RadzenTextBox @bind-Value="Customer.ShopName" />
        </RadzenColumn>
    </RadzenRow>
    <RadzenRow class="rz-mb-2">
        <RadzenColumn>
            <RadzenLabel Text="ชื่อลูกค้า"></RadzenLabel>
        </RadzenColumn>
        <RadzenColumn>
            <RadzenTextBox @bind-Value="Customer.CustomerName" />
        </RadzenColumn>
    </RadzenRow>
    <RadzenRow class="rz-mb-2">
        <RadzenColumn>
            <RadzenLabel Text="ที่อยู่"></RadzenLabel>
        </RadzenColumn>
        <RadzenColumn>
            <RadzenTextBox @bind-Value="Customer.Address" />
        </RadzenColumn>
    </RadzenRow>
    <RadzenRow class="rz-mb-2">
        <RadzenColumn>
            <RadzenLabel Text="จังหวัด"></RadzenLabel>
        </RadzenColumn>
        <RadzenColumn>
            <RadzenDropDown @bind-Value="Customer.Province" Data="ListProvince" Change="ProvinceOnChange" />
        </RadzenColumn>
    </RadzenRow>
    <RadzenRow class="rz-mb-2">
        <RadzenColumn>
            <RadzenLabel Text="อำเภอ"></RadzenLabel>
        </RadzenColumn>
        <RadzenColumn>
            <RadzenDropDown @bind-Value="Customer.District" Data="ListDistrict" Change="DistrictOnChange" />
        </RadzenColumn>
    </RadzenRow>
    <RadzenRow class="rz-mb-2">
        <RadzenColumn>
            <RadzenLabel Text="ตำบล"></RadzenLabel>
        </RadzenColumn>
        <RadzenColumn>
            <RadzenDropDown @bind-Value="Customer.SubDistrict" Data="ListSubDistrict"/>
        </RadzenColumn>
    </RadzenRow>
    <RadzenRow class="rz-mb-2">
        <RadzenColumn>
            <RadzenLabel Text="รหัสไปรษณีย์"></RadzenLabel>
        </RadzenColumn>
        <RadzenColumn>
            <RadzenTextBox @bind-Value="Customer.PostalCode" />
        </RadzenColumn>
    </RadzenRow>
</RadzenTemplateForm>

@code {
    private Customer Customer = new();
    private List<string>? ListProvince;
    private List<string>? ListDistrict;
    private List<string>? ListSubDistrict;

    private void ProvinceOnChange(Object SelectProvinceName)
    {
        Customer.District = "";
        Customer.SubDistrict = "";
        string? Name = SelectProvinceName.ToString();
        if (Name is not null)
        {
            ListDistrict = ThaiDataService.LoadDistrict(Name);
        }
    }

    private void DistrictOnChange(Object SelectDistrictName)
    {
        Customer.SubDistrict = "";
        string? Name = SelectDistrictName.ToString();
        if (Name is not null)
        {
            ListSubDistrict = ThaiDataService.LoadSubDistrict(Name);
        }
    }

    protected override void OnInitialized()
    {
        ListProvince = ThaiDataService.LoadProvince();
    }
}